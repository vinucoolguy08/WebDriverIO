{"version":3,"file":"checkElement.js","sourceRoot":"","sources":["../../lib/commands/checkElement.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,4CAAsD;AACtD,0CAA+C;AAC/C,6CAAwC;AAMxC,8CAAwD;AAKxD,SAA8B,YAAY,CACxC,OAAgB,EAChB,YAA0B,EAC1B,OAAgB,EAChB,OAAoB,EACpB,GAAW,EACX,mBAAwC;;;;;;oBAIlC,kBAAkB,GAAuB;wBAC7C,GAAG,EAAE,mBAAmB,CAAC,GAAG;wBAC5B,MAAM,mDACD,CAAC,qBAAqB,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,EAAC,mBAAmB,EAAE,mBAAmB,CAAC,MAAM,CAAC,mBAAmB,EAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAClI,CAAC,gBAAgB,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,EAAC,cAAc,EAAE,mBAAmB,CAAC,MAAM,CAAC,cAAc,EAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GACnH,CAAC,kBAAkB,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,EAAC,gBAAgB,EAAE,mBAAmB,CAAC,MAAM,CAAC,gBAAgB,EAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GACzH,EAAC,YAAY,EAAE,mBAAmB,CAAC,MAAM,CAAC,YAAY,IAAI,EAAE,EAAC,GAC7D,EAAC,cAAc,EAAE,mBAAmB,CAAC,MAAM,CAAC,cAAc,IAAI,EAAE,EAAC,CACrE;qBACF,CAAC;oBACmC,WAAM,IAAA,qBAAW,EAAC,OAAO,EAAE,YAAY,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,EAAE,kBAAkB,CAAC,EAAA;;oBAAlH,KAA+B,SAAmF,EAAjH,gBAAgB,sBAAA,EAAE,QAAQ,cAAA;oBAG3B,cAAc,GAAG,IAAA,8BAAoB,EAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;oBAClE,qBAAqB,GAAG;wBAC5B,gBAAgB,kBAAA;wBAChB,cAAc,EAAE;4BACd,GAAG,EAAE,mBAAmB,CAAC,GAAG,CAAC,cAAc;4BAC3C,MAAM,EAAE,cAAc;yBACvB;wBACD,QAAQ,UAAA;wBACR,aAAa,EAAE;4BACb,gBAAgB,EAAE,mBAAmB,CAAC,GAAG,CAAC,gBAAgB;4BAC1D,YAAY,EAAE,OAAO,CAAC,YAAY;4BAClC,cAAc,EAAE,OAAO,CAAC,cAAc;4BACtC,UAAU,EAAE,OAAO,CAAC,UAAU;4BAC9B,WAAW,EAAE,YAAY,CAAC,WAAW;4BACrC,UAAU,EAAE,YAAY,CAAC,UAAU;4BACnC,QAAQ,EAAE,IAAA,qBAAa,EAAC,YAAY,CAAC,YAAY,CAAC;4BAClD,eAAe,EAAE,mBAAmB,CAAC,GAAG,CAAC,eAAe;yBACzD;wBACD,4BAA4B,EAAE,YAAY,CAAC,mBAAmB;wBAC9D,WAAW,EAAE,mBAAmB,CAAC,GAAG,CAAC,WAAW;wBAChD,QAAQ,EAAE,mBAAmB,CAAC,GAAG,CAAC,QAAQ;wBAC1C,YAAY,EAAE,YAAY,CAAC,YAAY;qBACxC,CAAC;oBAGF,WAAO,IAAA,4BAAmB,EAAC,OAAO,CAAC,QAAQ,EAAE,qBAAqB,CAAC,EAAC;;;;CACrE;AAjDD,+BAiDC","sourcesContent":["import {executeImageCompare} from '../methods/images';\nimport {checkIsMobile} from '../helpers/utils';\nimport saveElement from './saveElement';\nimport {ImageCompareResult} from '../methods/images.interfaces';\nimport {Methods} from '../methods/methods.interface';\nimport {InstanceData} from '../methods/instanceData.interfaces';\nimport {Folders} from '../base.interface';\nimport {CheckElementOptions, SaveElementOptions} from './element.interfaces';\nimport {methodCompareOptions} from '../helpers/options';\n\n/**\n * Compare  an image of the element\n */\nexport default async function checkElement(\n  methods: Methods,\n  instanceData: InstanceData,\n  folders: Folders,\n  element: HTMLElement,\n  tag: string,\n  checkElementOptions: CheckElementOptions,\n): Promise<ImageCompareResult | number> {\n\n  // 1. Take the actual element screenshot and retrieve the needed data\n  const saveElementOptions: SaveElementOptions = {\n    wic: checkElementOptions.wic,\n    method: {\n      ...('disableCSSAnimation' in checkElementOptions.method ? {disableCSSAnimation: checkElementOptions.method.disableCSSAnimation} : {}),\n      ...('hideScrollBars' in checkElementOptions.method ? {hideScrollBars: checkElementOptions.method.hideScrollBars} : {}),\n      ...('resizeDimensions' in checkElementOptions.method ? {resizeDimensions: checkElementOptions.method.resizeDimensions} : {}),\n      ...{hideElements: checkElementOptions.method.hideElements || []},\n      ...{removeElements: checkElementOptions.method.removeElements || []},\n    }\n  };\n  const {devicePixelRatio, fileName} = await saveElement(methods, instanceData, folders, element, tag, saveElementOptions);\n\n  // 2a. Determine the options\n  const compareOptions = methodCompareOptions(checkElementOptions.method);\n  const executeCompareOptions = {\n    devicePixelRatio,\n    compareOptions: {\n      wic: checkElementOptions.wic.compareOptions,\n      method: compareOptions,\n    },\n    fileName,\n    folderOptions: {\n      autoSaveBaseline: checkElementOptions.wic.autoSaveBaseline,\n      actualFolder: folders.actualFolder,\n      baselineFolder: folders.baselineFolder,\n      diffFolder: folders.diffFolder,\n      browserName: instanceData.browserName,\n      deviceName: instanceData.deviceName,\n      isMobile: checkIsMobile(instanceData.platformName),\n      savePerInstance: checkElementOptions.wic.savePerInstance,\n    },\n    isAndroidNativeWebScreenshot: instanceData.nativeWebScreenshot,\n    isHybridApp: checkElementOptions.wic.isHybridApp,\n    logLevel: checkElementOptions.wic.logLevel,\n    platformName: instanceData.platformName,\n  };\n\n  // 2b Now execute the compare and return the data\n  return executeImageCompare(methods.executor, executeCompareOptions);\n}\n"]}